<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>メモアプリ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;600;700&display=swap');
        body {
            font-family: 'Noto Sans JP', sans-serif;
        }
        .store-name-input {
            background: transparent;
            border: none;
            outline: none;
            color: white;
            font-size: 1.125rem;
            font-weight: 600;
            width: 100%;
        }
        .store-name-input:focus {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            padding: 2px 6px;
        }
        .page {
            display: none;
        }
        .page.active {
            display: block;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-sky-100 to-cyan-200 min-h-screen">
    <!-- ナビゲーションバー -->
    <nav class="bg-white/90 backdrop-blur-sm shadow-lg border-b border-sky-200 sticky top-0 z-50">
        <div class="container mx-auto px-4">
            <div class="flex justify-between items-center py-4">
                <h1 class="text-xl font-bold text-slate-800 cursor-pointer" onclick="showPage('home')">📝 メモアプリ</h1>
                <div class="flex gap-4">
                    <button onclick="showPage('home')" class="nav-btn text-slate-600 hover:text-sky-600 font-medium transition-colors">ホーム</button>
                    <button onclick="showPage('shopping')" class="nav-btn text-slate-600 hover:text-sky-600 font-medium transition-colors">買い物メモ</button>
                    <button onclick="showPage('memo')" class="nav-btn text-slate-600 hover:text-sky-600 font-medium transition-colors">ToDo</button>
                    <button onclick="showPage('gift')" class="nav-btn text-slate-600 hover:text-sky-600 font-medium transition-colors">贈り物メモ</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- トップページ -->
    <div id="homePage" class="page active">
        <div class="container mx-auto px-4 py-12 max-w-4xl">
            <div class="text-center mb-12">
                <h1 class="text-4xl font-bold text-slate-800 mb-4">📝 メモアプリ</h1>
                <p class="text-xl text-slate-600 mb-8">日常の買い物やメモを効率的に管理しましょう</p>
            </div>

            <div class="grid md:grid-cols-2 gap-8 max-w-3xl mx-auto">
                <!-- 買い物メモカード -->
                <div class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-xl border border-sky-200 p-8 hover:shadow-2xl transition-all duration-300 cursor-pointer" onclick="showPage('shopping')">
                    <div class="text-center">
                        <div class="text-6xl mb-4">🛒</div>
                        <h2 class="text-2xl font-bold text-slate-800 mb-3">買い物メモ</h2>
                        <p class="text-slate-600 mb-6">店舗別に買い物リストを管理。チェックボックスで買い物の進捗を確認できます。</p>
                        <div class="bg-gradient-to-r from-sky-600 to-cyan-600 text-white px-6 py-3 rounded-lg font-medium inline-block">
                            買い物メモを開く
                        </div>
                    </div>
                </div>

                <!-- ToDoカード -->
                <div class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-xl border border-sky-200 p-8 hover:shadow-2xl transition-all duration-300 cursor-pointer" onclick="showPage('memo')">
                    <div class="text-center">
                        <div class="text-6xl mb-4">📋</div>
                        <h2 class="text-2xl font-bold text-slate-800 mb-3">ToDo</h2>
                        <p class="text-slate-600 mb-6">思いついたアイデアや重要な情報を素早くメモ。カテゴリ別に整理できます。</p>
                        <div class="bg-gradient-to-r from-cyan-600 to-teal-600 text-white px-6 py-3 rounded-lg font-medium inline-block">
                            ToDoを開く
                        </div>
                    </div>
                </div>
            </div>

            <!-- 贈り物メモカード -->
            <div class="mt-8 max-w-lg mx-auto">
                <div class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-xl border border-sky-200 p-8 hover:shadow-2xl transition-all duration-300 cursor-pointer" onclick="showPage('gift')">
                    <div class="text-center">
                        <div class="text-6xl mb-4">🎁</div>
                        <h2 class="text-2xl font-bold text-slate-800 mb-3">贈り物メモ</h2>
                        <p class="text-slate-600 mb-6">慶事・弔事の贈り物を記録管理。日付、相手、金額、内容を表形式で整理できます。</p>
                        <div class="bg-gradient-to-r from-purple-600 to-pink-600 text-white px-6 py-3 rounded-lg font-medium inline-block">
                            贈り物メモを開く
                        </div>
                    </div>
                </div>
            </div>
            </div>

            <!-- 機能紹介 -->
            <div class="mt-16 text-center">
                <h3 class="text-2xl font-bold text-slate-800 mb-8">主な機能</h3>
                <div class="grid md:grid-cols-4 gap-6">
                    <div class="bg-white/60 backdrop-blur-sm rounded-xl p-6 border border-sky-100">
                        <div class="text-3xl mb-3">🛒</div>
                        <h4 class="font-semibold text-slate-800 mb-2">買い物管理</h4>
                        <p class="text-sm text-slate-600">店舗別に買い物リストを整理</p>
                    </div>
                    <div class="bg-white/60 backdrop-blur-sm rounded-xl p-6 border border-sky-100">
                        <div class="text-3xl mb-3">📋</div>
                        <h4 class="font-semibold text-slate-800 mb-2">ToDo管理</h4>
                        <p class="text-sm text-slate-600">カテゴリ別にタスクを管理</p>
                    </div>
                    <div class="bg-white/60 backdrop-blur-sm rounded-xl p-6 border border-sky-100">
                        <div class="text-3xl mb-3">🎁</div>
                        <h4 class="font-semibold text-slate-800 mb-2">贈り物記録</h4>
                        <p class="text-sm text-slate-600">慶事・弔事の贈り物を表形式で管理</p>
                    </div>
                    <div class="bg-white/60 backdrop-blur-sm rounded-xl p-6 border border-sky-100">
                        <div class="text-3xl mb-3">🎨</div>
                        <h4 class="font-semibold text-slate-800 mb-2">美しいデザイン</h4>
                        <p class="text-sm text-slate-600">空色をベースとしたクールで洗練された見た目</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 買い物メモページ -->
    <div id="shoppingPage" class="page">
        <div class="container mx-auto px-4 py-8 max-w-4xl">
            <!-- ヘッダー -->
            <div class="text-center mb-8">
                <h1 class="text-3xl font-bold text-slate-800 mb-2">🛒 買い物メモ</h1>
                <p class="text-slate-600">店舗別に買い物リストを管理しましょう</p>
            </div>

            <!-- 新しい店舗追加 -->
            <div class="bg-white/80 backdrop-blur-sm rounded-xl shadow-xl border border-sky-200 p-6 mb-8">
                <h2 class="text-xl font-semibold text-slate-800 mb-4">新しい店舗を追加</h2>
                <div class="flex gap-3">
                    <input 
                        type="text" 
                        id="newStoreInput" 
                        placeholder="店舗名を入力（例：スーパーマーケット）"
                        class="flex-1 px-4 py-3 border border-sky-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent outline-none bg-white/70"
                    >
                    <button 
                        onclick="addStore()" 
                        class="bg-gradient-to-r from-sky-600 to-cyan-600 hover:from-sky-700 hover:to-cyan-700 text-white px-6 py-3 rounded-lg font-medium transition-all duration-200 shadow-lg"
                    >
                        追加
                    </button>
                </div>
            </div>

            <!-- 店舗リスト -->
            <div id="storesList" class="space-y-6">
                <!-- サンプル店舗 -->
                <div class="bg-white/80 backdrop-blur-sm rounded-xl shadow-xl border border-sky-200 overflow-hidden">
                    <div class="bg-gradient-to-r from-sky-600 to-cyan-600 text-white p-4">
                        <div class="flex justify-between items-center">
                            <div class="flex items-center gap-2 flex-1">
                                <span>🏪</span>
                                <input 
                                    type="text" 
                                    value="スーパーマーケット" 
                                    class="store-name-input"
                                    onblur="saveStoreName(this)"
                                    onkeypress="handleStoreNameKeyPress(event, this)"
                                >
                            </div>
                            <button onclick="removeStore(this)" class="text-white hover:text-red-200 text-sm ml-4">店舗削除</button>
                        </div>
                    </div>
                    <div class="p-6">
                        <div class="flex gap-3 mb-4">
                            <input 
                                type="text" 
                                placeholder="買いたいものを入力"
                                class="flex-1 px-4 py-2 border border-sky-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent outline-none bg-white/70"
                                onkeypress="handleItemKeyPress(event, this)"
                            >
                            <button 
                                onclick="addItem(this)" 
                                class="bg-gradient-to-r from-sky-600 to-cyan-600 hover:from-sky-700 hover:to-cyan-700 text-white px-4 py-2 rounded-lg font-medium transition-all duration-200"
                            >
                                追加
                            </button>
                        </div>
                        <ul class="space-y-2">
                            <li class="flex items-center justify-between bg-sky-50/70 p-3 rounded-lg border border-sky-100">
                                <div class="flex items-center gap-3">
                                    <input type="checkbox" class="w-4 h-4 text-sky-600 rounded focus:ring-sky-500" onchange="toggleItem(this)">
                                    <span class="text-slate-800">牛乳</span>
                                </div>
                                <button onclick="removeItem(this)" class="text-red-500 hover:text-red-700 text-sm">削除</button>
                            </li>
                            <li class="flex items-center justify-between bg-sky-50/70 p-3 rounded-lg border border-sky-100">
                                <div class="flex items-center gap-3">
                                    <input type="checkbox" class="w-4 h-4 text-sky-600 rounded focus:ring-sky-500" onchange="toggleItem(this)">
                                    <span class="text-slate-800">パン</span>
                                </div>
                                <button onclick="removeItem(this)" class="text-red-500 hover:text-red-700 text-sm">削除</button>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ToDoページ -->
    <div id="memoPage" class="page">
        <div class="container mx-auto px-4 py-8 max-w-4xl">
            <!-- ヘッダー -->
            <div class="text-center mb-8">
                <h1 class="text-3xl font-bold text-slate-800 mb-2">📋 ToDo</h1>
                <p class="text-slate-600">アイデアや重要な情報をメモしましょう</p>
            </div>

            <!-- 新しいToDo追加 -->
            <div class="bg-white/80 backdrop-blur-sm rounded-xl shadow-xl border border-sky-200 p-6 mb-8">
                <h2 class="text-xl font-semibold text-slate-800 mb-4">新しいToDoを追加</h2>
                <div class="space-y-3">
                    <input 
                        type="text" 
                        id="newMemoTitle" 
                        placeholder="ToDoのタイトル"
                        class="w-full px-4 py-3 border border-sky-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent outline-none bg-white/70"
                    >
                    <textarea 
                        id="newMemoContent" 
                        placeholder="ToDoの内容を入力してください..."
                        rows="4"
                        class="w-full px-4 py-3 border border-sky-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent outline-none bg-white/70 resize-none"
                    ></textarea>
                    <div class="flex gap-3">
                        <select id="memoCategory" class="px-4 py-3 border border-sky-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent outline-none bg-white/70">
                            <option value="一般">一般</option>
                            <option value="仕事">仕事</option>
                            <option value="プライベート">プライベート</option>
                            <option value="アイデア">アイデア</option>
                            <option value="重要">重要</option>
                        </select>
                        <button 
                            onclick="addMemo()" 
                            class="bg-gradient-to-r from-cyan-600 to-teal-600 hover:from-cyan-700 hover:to-teal-700 text-white px-6 py-3 rounded-lg font-medium transition-all duration-200 shadow-lg"
                        >
                            ToDoを追加
                        </button>
                    </div>
                </div>
            </div>

            <!-- ToDoリスト -->
            <div id="memosList" class="space-y-4">
                <!-- サンプルメモ -->
                <div class="bg-white/80 backdrop-blur-sm rounded-xl shadow-lg border border-sky-200 p-6">
                    <div class="flex justify-between items-start mb-3">
                        <div class="flex items-center gap-3">
                            <span class="bg-sky-100 text-sky-800 px-3 py-1 rounded-full text-sm font-medium">一般</span>
                            <h3 class="text-lg font-semibold text-slate-800">今日のタスク</h3>
                        </div>
                        <button onclick="removeMemo(this)" class="text-red-500 hover:text-red-700 text-sm">削除</button>
                    </div>
                    <p class="text-slate-600 leading-relaxed">・プレゼン資料の作成<br>・会議の準備<br>・メールの返信</p>
                    <div class="text-xs text-slate-400 mt-3">2024年12月19日</div>
                </div>

                <div class="bg-white/80 backdrop-blur-sm rounded-xl shadow-lg border border-sky-200 p-6">
                    <div class="flex justify-between items-start mb-3">
                        <div class="flex items-center gap-3">
                            <span class="bg-teal-100 text-teal-800 px-3 py-1 rounded-full text-sm font-medium">アイデア</span>
                            <h3 class="text-lg font-semibold text-slate-800">アプリの改善案</h3>
                        </div>
                        <button onclick="removeMemo(this)" class="text-red-500 hover:text-red-700 text-sm">削除</button>
                    </div>
                    <p class="text-slate-600 leading-relaxed">ダークモードの追加、検索機能の実装、データのエクスポート機能</p>
                    <div class="text-xs text-slate-400 mt-3">2024年12月19日</div>
                </div>
            </div>
        </div>
    </div>

    <!-- 贈り物メモページ -->
    <div id="giftPage" class="page">
        <div class="container mx-auto px-4 py-8 max-w-6xl">
            <!-- ヘッダー -->
            <div class="text-center mb-8">
                <h1 class="text-3xl font-bold text-slate-800 mb-2">🎁 贈り物メモ</h1>
                <p class="text-slate-600">慶事・弔事の贈り物を記録管理しましょう</p>
            </div>

            <!-- 新しい贈り物記録追加 -->
            <div class="bg-white/80 backdrop-blur-sm rounded-xl shadow-xl border border-sky-200 p-6 mb-8">
                <h2 class="text-xl font-semibold text-slate-800 mb-4">新しい贈り物記録を追加</h2>
                <div class="grid md:grid-cols-2 lg:grid-cols-5 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-2">種別</label>
                        <select id="giftType" class="w-full px-4 py-3 border border-sky-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent outline-none bg-white/70">
                            <option value="慶事">慶事</option>
                            <option value="弔事">弔事</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-2">年月日</label>
                        <input 
                            type="date" 
                            id="giftDate" 
                            class="w-full px-4 py-3 border border-sky-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent outline-none bg-white/70"
                        >
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-2">相手</label>
                        <input 
                            type="text" 
                            id="giftRecipient" 
                            placeholder="相手の名前"
                            class="w-full px-4 py-3 border border-sky-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent outline-none bg-white/70"
                        >
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-2">金額</label>
                        <input 
                            type="number" 
                            id="giftAmount" 
                            placeholder="金額（円）"
                            class="w-full px-4 py-3 border border-sky-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent outline-none bg-white/70"
                        >
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-2">内容</label>
                        <input 
                            type="text" 
                            id="giftContent" 
                            placeholder="贈り物の内容"
                            class="w-full px-4 py-3 border border-sky-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent outline-none bg-white/70"
                        >
                    </div>
                </div>
                <div class="mt-4 text-center">
                    <button 
                        onclick="addGift()" 
                        class="bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white px-6 py-3 rounded-lg font-medium transition-all duration-200 shadow-lg"
                    >
                        記録を追加
                    </button>
                </div>
            </div>

            <!-- 慶事・弔事タブ -->
            <div class="mb-6">
                <div class="flex bg-white/80 backdrop-blur-sm rounded-lg p-1 border border-sky-200">
                    <button 
                        id="keiji-tab" 
                        onclick="switchGiftTab('keiji')" 
                        class="flex-1 py-2 px-4 rounded-md font-medium transition-all duration-200 bg-gradient-to-r from-pink-500 to-rose-500 text-white"
                    >
                        慶事
                    </button>
                    <button 
                        id="chouji-tab" 
                        onclick="switchGiftTab('chouji')" 
                        class="flex-1 py-2 px-4 rounded-md font-medium transition-all duration-200 text-slate-600 hover:text-slate-800"
                    >
                        弔事
                    </button>
                </div>
            </div>

            <!-- 慶事テーブル -->
            <div id="keiji-table" class="gift-table">
                <div class="bg-white/80 backdrop-blur-sm rounded-xl shadow-xl border border-sky-200 overflow-hidden">
                    <div class="bg-gradient-to-r from-pink-500 to-rose-500 text-white p-4">
                        <h3 class="text-lg font-semibold">🌸 慶事の記録</h3>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-pink-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider">年月日</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider">相手</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider">金額</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider">内容</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider">操作</th>
                                </tr>
                            </thead>
                            <tbody id="keiji-tbody" class="bg-white divide-y divide-gray-200">
                                <!-- サンプルデータ -->
                                <tr class="hover:bg-pink-50/50">
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-800">2024-03-15</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-800">田中太郎</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-800">¥30,000</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-800">結婚祝い</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm">
                                        <button onclick="removeGift(this)" class="text-red-500 hover:text-red-700">削除</button>
                                    </td>
                                </tr>
                                <tr class="hover:bg-pink-50/50">
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-800">2024-05-20</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-800">佐藤花子</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-800">¥10,000</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-800">出産祝い</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm">
                                        <button onclick="removeGift(this)" class="text-red-500 hover:text-red-700">削除</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- 弔事テーブル -->
            <div id="chouji-table" class="gift-table" style="display: none;">
                <div class="bg-white/80 backdrop-blur-sm rounded-xl shadow-xl border border-sky-200 overflow-hidden">
                    <div class="bg-gradient-to-r from-slate-600 to-gray-600 text-white p-4">
                        <h3 class="text-lg font-semibold">🕊️ 弔事の記録</h3>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-slate-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider">年月日</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider">相手</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider">金額</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider">内容</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider">操作</th>
                                </tr>
                            </thead>
                            <tbody id="chouji-tbody" class="bg-white divide-y divide-gray-200">
                                <!-- サンプルデータ -->
                                <tr class="hover:bg-slate-50/50">
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-800">2024-02-10</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-800">山田一郎</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-800">¥5,000</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-800">香典</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm">
                                        <button onclick="removeGift(this)" class="text-red-500 hover:text-red-700">削除</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ページ遷移機能
        function showPage(pageId) {
            // すべてのページを非表示
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // 指定されたページを表示
            document.getElementById(pageId + 'Page').classList.add('active');
            
            // ナビゲーションボタンのアクティブ状態を更新
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('text-sky-600', 'font-bold');
                btn.classList.add('text-slate-600');
            });
            
            // 現在のページのボタンをアクティブに
            event.target.classList.remove('text-slate-600');
            event.target.classList.add('text-sky-600', 'font-bold');
        }

        // 買い物メモ機能
        const storeColors = [
            { gradient: 'from-sky-600 to-cyan-600', hover: 'hover:from-sky-700 hover:to-cyan-700', focus: 'focus:ring-sky-500' },
            { gradient: 'from-cyan-600 to-teal-600', hover: 'hover:from-cyan-700 hover:to-teal-700', focus: 'focus:ring-cyan-500' },
            { gradient: 'from-teal-600 to-emerald-600', hover: 'hover:from-teal-700 hover:to-emerald-700', focus: 'focus:ring-teal-500' },
            { gradient: 'from-blue-600 to-sky-600', hover: 'hover:from-blue-700 hover:to-sky-700', focus: 'focus:ring-blue-500' },
            { gradient: 'from-indigo-600 to-blue-600', hover: 'hover:from-indigo-700 hover:to-blue-700', focus: 'focus:ring-indigo-500' },
            { gradient: 'from-slate-600 to-gray-600', hover: 'hover:from-slate-700 hover:to-gray-700', focus: 'focus:ring-slate-500' }
        ];
        
        let colorIndex = 0;

        function addStore() {
            const input = document.getElementById('newStoreInput');
            const storeName = input.value.trim();
            
            if (!storeName) {
                alert('店舗名を入力してください');
                return;
            }

            const storesList = document.getElementById('storesList');
            const colorScheme = storeColors[colorIndex % storeColors.length];
            colorIndex++;

            const storeHTML = `
                <div class="bg-white/80 backdrop-blur-sm rounded-xl shadow-xl border border-sky-200 overflow-hidden">
                    <div class="bg-gradient-to-r ${colorScheme.gradient} text-white p-4">
                        <div class="flex justify-between items-center">
                            <div class="flex items-center gap-2 flex-1">
                                <span>🏪</span>
                                <input 
                                    type="text" 
                                    value="${storeName}" 
                                    class="store-name-input"
                                    onblur="saveStoreName(this)"
                                    onkeypress="handleStoreNameKeyPress(event, this)"
                                >
                            </div>
                            <button onclick="removeStore(this)" class="text-white hover:text-red-200 text-sm ml-4">店舗削除</button>
                        </div>
                    </div>
                    <div class="p-6">
                        <div class="flex gap-3 mb-4">
                            <input 
                                type="text" 
                                placeholder="買いたいものを入力"
                                class="flex-1 px-4 py-2 border border-sky-300 rounded-lg ${colorScheme.focus} focus:border-transparent outline-none bg-white/70"
                                onkeypress="handleItemKeyPress(event, this)"
                            >
                            <button 
                                onclick="addItem(this)" 
                                class="bg-gradient-to-r ${colorScheme.gradient} ${colorScheme.hover} text-white px-4 py-2 rounded-lg font-medium transition-all duration-200"
                            >
                                追加
                            </button>
                        </div>
                        <ul class="space-y-2">
                        </ul>
                    </div>
                </div>
            `;

            storesList.insertAdjacentHTML('beforeend', storeHTML);
            input.value = '';
        }

        function addItem(button) {
            const input = button.previousElementSibling;
            const itemName = input.value.trim();
            
            if (!itemName) {
                alert('商品名を入力してください');
                return;
            }

            const ul = button.parentElement.nextElementSibling;

            const itemHTML = `
                <li class="flex items-center justify-between bg-sky-50/70 p-3 rounded-lg border border-sky-100">
                    <div class="flex items-center gap-3">
                        <input type="checkbox" class="w-4 h-4 text-sky-600 rounded focus:ring-sky-500" onchange="toggleItem(this)">
                        <span class="text-slate-800">${itemName}</span>
                    </div>
                    <button onclick="removeItem(this)" class="text-red-500 hover:text-red-700 text-sm">削除</button>
                </li>
            `;

            ul.insertAdjacentHTML('beforeend', itemHTML);
            input.value = '';
        }

        function removeItem(button) {
            button.closest('li').remove();
        }

        function removeStore(button) {
            if (confirm('この店舗と全ての商品を削除しますか？')) {
                button.closest('.bg-white\\/80').remove();
            }
        }

        function handleItemKeyPress(event, input) {
            if (event.key === 'Enter') {
                const button = input.nextElementSibling;
                addItem(button);
            }
        }

        function handleStoreNameKeyPress(event, input) {
            if (event.key === 'Enter') {
                input.blur();
            }
        }

        function saveStoreName(input) {
            // 店舗名が保存されました
        }

        function toggleItem(checkbox) {
            const span = checkbox.nextElementSibling;
            if (checkbox.checked) {
                span.classList.add('line-through', 'text-slate-500');
            } else {
                span.classList.remove('line-through', 'text-slate-500');
            }
        }

        // メモ機能
        function addMemo() {
            const titleInput = document.getElementById('newMemoTitle');
            const contentInput = document.getElementById('newMemoContent');
            const categorySelect = document.getElementById('memoCategory');
            
            const title = titleInput.value.trim();
            const content = contentInput.value.trim();
            const category = categorySelect.value;
            
            if (!title || !content) {
                alert('タイトルと内容を入力してください');
                return;
            }

            const memosList = document.getElementById('memosList');
            const today = new Date().toLocaleDateString('ja-JP');
            
            const categoryColors = {
                '一般': 'bg-sky-100 text-sky-800',
                '仕事': 'bg-blue-100 text-blue-800',
                'プライベート': 'bg-green-100 text-green-800',
                'アイデア': 'bg-teal-100 text-teal-800',
                '重要': 'bg-red-100 text-red-800'
            };

            const memoHTML = `
                <div class="bg-white/80 backdrop-blur-sm rounded-xl shadow-lg border border-sky-200 p-6">
                    <div class="flex justify-between items-start mb-3">
                        <div class="flex items-center gap-3">
                            <span class="${categoryColors[category]} px-3 py-1 rounded-full text-sm font-medium">${category}</span>
                            <h3 class="text-lg font-semibold text-slate-800">${title}</h3>
                        </div>
                        <button onclick="removeMemo(this)" class="text-red-500 hover:text-red-700 text-sm">削除</button>
                    </div>
                    <p class="text-slate-600 leading-relaxed">${content.replace(/\n/g, '<br>')}</p>
                    <div class="text-xs text-slate-400 mt-3">${today}</div>
                </div>
            `;

            memosList.insertAdjacentHTML('afterbegin', memoHTML);
            
            // フォームをクリア
            titleInput.value = '';
            contentInput.value = '';
            categorySelect.value = '一般';
        }

        function removeMemo(button) {
            if (confirm('このメモを削除しますか？')) {
                button.closest('.bg-white\\/80').remove();
            }
        }

        // 新しい店舗入力でEnterキーを押した時の処理
        document.getElementById('newStoreInput').addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                addStore();
            }
        });

        // 贈り物メモ機能
        function addGift() {
            const type = document.getElementById('giftType').value;
            const date = document.getElementById('giftDate').value;
            const recipient = document.getElementById('giftRecipient').value.trim();
            const amount = document.getElementById('giftAmount').value;
            const content = document.getElementById('giftContent').value.trim();
            
            if (!date || !recipient || !amount || !content) {
                alert('すべての項目を入力してください');
                return;
            }

            const tbody = type === '慶事' ? document.getElementById('keiji-tbody') : document.getElementById('chouji-tbody');
            const formattedAmount = new Intl.NumberFormat('ja-JP', { style: 'currency', currency: 'JPY' }).format(amount);
            const hoverClass = type === '慶事' ? 'hover:bg-pink-50/50' : 'hover:bg-slate-50/50';

            const rowHTML = `
                <tr class="${hoverClass}">
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-800">${date}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-800">${recipient}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-800">${formattedAmount}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-800">${content}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm">
                        <button onclick="removeGift(this)" class="text-red-500 hover:text-red-700">削除</button>
                    </td>
                </tr>
            `;

            tbody.insertAdjacentHTML('beforeend', rowHTML);
            
            // フォームをクリア
            document.getElementById('giftDate').value = '';
            document.getElementById('giftRecipient').value = '';
            document.getElementById('giftAmount').value = '';
            document.getElementById('giftContent').value = '';
            
            // 追加したタブに切り替え
            if (type === '慶事') {
                switchGiftTab('keiji');
            } else {
                switchGiftTab('chouji');
            }
        }

        function removeGift(button) {
            if (confirm('この記録を削除しますか？')) {
                button.closest('tr').remove();
            }
        }

        function switchGiftTab(tab) {
            // タブボタンの状態を更新
            const keijiTab = document.getElementById('keiji-tab');
            const choujiTab = document.getElementById('chouji-tab');
            
            if (tab === 'keiji') {
                keijiTab.className = 'flex-1 py-2 px-4 rounded-md font-medium transition-all duration-200 bg-gradient-to-r from-pink-500 to-rose-500 text-white';
                choujiTab.className = 'flex-1 py-2 px-4 rounded-md font-medium transition-all duration-200 text-slate-600 hover:text-slate-800';
                document.getElementById('keiji-table').style.display = 'block';
                document.getElementById('chouji-table').style.display = 'none';
            } else {
                choujiTab.className = 'flex-1 py-2 px-4 rounded-md font-medium transition-all duration-200 bg-gradient-to-r from-slate-600 to-gray-600 text-white';
                keijiTab.className = 'flex-1 py-2 px-4 rounded-md font-medium transition-all duration-200 text-slate-600 hover:text-slate-800';
                document.getElementById('chouji-table').style.display = 'block';
                document.getElementById('keiji-table').style.display = 'none';
            }
        }

        // メモのタイトル入力でEnterキーを押した時の処理
        document.getElementById('newMemoTitle').addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                document.getElementById('newMemoContent').focus();
            }
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'971a7bbfc47fd3e7',t:'MTc1NTYxNTIzNy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
